<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Casino/Gaming Industry POC for Microsoft Fabric"><meta name=author content="Microsoft Fabric POC Team"><link href=https://fgarofalo56.github.io/Suppercharge_Microsoft_Fabric/compliance-templates/CTR_TEMPLATE/ rel=canonical><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Currency Transaction Report (CTR) Template - Supercharge Microsoft Fabric</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#currency-transaction-report-ctr-template class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Supercharge Microsoft Fabric" class="md-header__button md-logo" aria-label="Supercharge Microsoft Fabric" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Supercharge Microsoft Fabric </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Currency Transaction Report (CTR) Template </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/fgarofalo56/Suppercharge_Microsoft_Fabric title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Suppercharge_Microsoft_Fabric </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../PREREQUISITES/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../ARCHITECTURE/ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../tutorials/README.md class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../poc-agenda/README.md class=md-tabs__link> POC Agenda </a> </li> <li class=md-tabs__item> <a href=../../FAQ/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../infra/README.md class=md-tabs__link> Infrastructure </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Supercharge Microsoft Fabric" class="md-nav__button md-logo" aria-label="Supercharge Microsoft Fabric" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Supercharge Microsoft Fabric </label> <div class=md-nav__source> <a href=https://github.com/fgarofalo56/Suppercharge_Microsoft_Fabric title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Suppercharge_Microsoft_Fabric </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../QUICK_START/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../CHANGELOG.md class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../PREREQUISITES/ class=md-nav__link> <span class=md-ellipsis> Prerequisites </span> </a> </li> <li class=md-nav__item> <a href=../../DEPLOYMENT/ class=md-nav__link> <span class=md-ellipsis> Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../COST_ESTIMATION/ class=md-nav__link> <span class=md-ellipsis> Cost Estimation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ARCHITECTURE/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../SECURITY/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../../diagrams/architecture-overview/ class=md-nav__link> <span class=md-ellipsis> Diagrams </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tutorials/README.md class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/00-environment-setup/README.md class=md-nav__link> <span class=md-ellipsis> 00 - Environment Setup </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/01-bronze-layer/README.md class=md-nav__link> <span class=md-ellipsis> 01 - Bronze Layer </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/02-silver-layer/README.md class=md-nav__link> <span class=md-ellipsis> 02 - Silver Layer </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/03-gold-layer/README.md class=md-nav__link> <span class=md-ellipsis> 03 - Gold Layer </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/04-real-time-analytics/README.md class=md-nav__link> <span class=md-ellipsis> 04 - Real-Time Analytics </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/05-direct-lake-powerbi/README.md class=md-nav__link> <span class=md-ellipsis> 05 - Direct Lake & Power BI </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/06-data-pipelines/README.md class=md-nav__link> <span class=md-ellipsis> 06 - Data Pipelines </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/07-governance-purview/README.md class=md-nav__link> <span class=md-ellipsis> 07 - Governance & Purview </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/08-database-mirroring/README.md class=md-nav__link> <span class=md-ellipsis> 08 - Database Mirroring </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/09-advanced-ai-ml/README.md class=md-nav__link> <span class=md-ellipsis> 09 - Advanced AI/ML </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/10-teradata-migration/README.md class=md-nav__link> <span class=md-ellipsis> 10 - Teradata Migration </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/11-sas-connectivity/README.md class=md-nav__link> <span class=md-ellipsis> 11 - SAS Connectivity </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/12-cicd-devops/README.md class=md-nav__link> <span class=md-ellipsis> 12 - CI/CD & DevOps </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/13-migration-planning/README.md class=md-nav__link> <span class=md-ellipsis> 13 - Migration Planning </span> </a> </li> <li class=md-nav__item> <a href=../../tutorials/CHEAT_SHEET.md class=md-nav__link> <span class=md-ellipsis> Cheat Sheet </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> POC Agenda </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> POC Agenda </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../poc-agenda/README.md class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../poc-agenda/day1-medallion-foundation.md class=md-nav__link> <span class=md-ellipsis> Day 1 - Medallion Foundation </span> </a> </li> <li class=md-nav__item> <a href=../../poc-agenda/day2-transformations-realtime.md class=md-nav__link> <span class=md-ellipsis> Day 2 - Transformations & Real-Time </span> </a> </li> <li class=md-nav__item> <a href=../../poc-agenda/day3-bi-governance-mirroring.md class=md-nav__link> <span class=md-ellipsis> Day 3 - BI, Governance & Mirroring </span> </a> </li> <li class=md-nav__item> <a href=../../poc-agenda/DEMO_RUNBOOK.md class=md-nav__link> <span class=md-ellipsis> Demo Runbook </span> </a> </li> <li class=md-nav__item> <a href=../../poc-agenda/DIAGRAM_GUIDE.md class=md-nav__link> <span class=md-ellipsis> Diagram Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../GLOSSARY/ class=md-nav__link> <span class=md-ellipsis> Glossary </span> </a> </li> <li class=md-nav__item> <a href=../../STYLE_GUIDE/ class=md-nav__link> <span class=md-ellipsis> Style Guide </span> </a> </li> <li class=md-nav__item> <a href=../../VISUAL_STANDARDS/ class=md-nav__link> <span class=md-ellipsis> Visual Standards </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Infrastructure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../infra/README.md class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../CONTRIBUTING.md class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#regulatory-requirements class=md-nav__link> <span class=md-ellipsis> Regulatory Requirements </span> </a> </li> <li class=md-nav__item> <a href=#data-fields-required class=md-nav__link> <span class=md-ellipsis> Data Fields Required </span> </a> <nav class=md-nav aria-label="Data Fields Required"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#part-i-person-involved-in-transaction class=md-nav__link> <span class=md-ellipsis> Part I - Person Involved in Transaction </span> </a> </li> <li class=md-nav__item> <a href=#part-ii-transaction-information class=md-nav__link> <span class=md-ellipsis> Part II - Transaction Information </span> </a> </li> <li class=md-nav__item> <a href=#part-iii-casinocard-club-information class=md-nav__link> <span class=md-ellipsis> Part III - Casino/Card Club Information </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sql-query-for-ctr-data-extraction class=md-nav__link> <span class=md-ellipsis> SQL Query for CTR Data Extraction </span> </a> </li> <li class=md-nav__item> <a href=#pyspark-implementation class=md-nav__link> <span class=md-ellipsis> PySpark Implementation </span> </a> </li> <li class=md-nav__item> <a href=#fincen-filing-format class=md-nav__link> <span class=md-ellipsis> FinCEN Filing Format </span> </a> </li> <li class=md-nav__item> <a href=#filing-workflow class=md-nav__link> <span class=md-ellipsis> Filing Workflow </span> </a> </li> <li class=md-nav__item> <a href=#compliance-checklist class=md-nav__link> <span class=md-ellipsis> Compliance Checklist </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=currency-transaction-report-ctr-template>Currency Transaction Report (CTR) Template<a class=headerlink href=#currency-transaction-report-ctr-template title="Permanent link">&para;</a></h1> <blockquote> <p><strong>Compliance &gt; CTR Template</strong></p> </blockquote> <hr> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This template documents the data requirements and format for Currency Transaction Reports (CTR) as required by the Bank Secrecy Act (BSA) and FinCEN regulations. CTRs must be filed for cash transactions exceeding $10,000.</p> <hr> <h2 id=regulatory-requirements>Regulatory Requirements<a class=headerlink href=#regulatory-requirements title="Permanent link">&para;</a></h2> <ul> <li><strong>Threshold:</strong> $10,000 in cash (single transaction or aggregated daily)</li> <li><strong>Filing Deadline:</strong> 15 days from transaction date</li> <li><strong>Retention:</strong> 5 years minimum</li> <li><strong>Authority:</strong> FinCEN Form 112</li> </ul> <hr> <h2 id=data-fields-required>Data Fields Required<a class=headerlink href=#data-fields-required title="Permanent link">&para;</a></h2> <h3 id=part-i-person-involved-in-transaction>Part I - Person Involved in Transaction<a class=headerlink href=#part-i-person-involved-in-transaction title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Field</th> <th>Source Table</th> <th>Source Column</th> <th>Transformation</th> </tr> </thead> <tbody> <tr> <td>Last Name</td> <td>dim_player</td> <td>last_name</td> <td>Direct</td> </tr> <tr> <td>First Name</td> <td>dim_player</td> <td>first_name</td> <td>Direct</td> </tr> <tr> <td>Middle Name</td> <td>dim_player</td> <td>middle_name</td> <td>Direct</td> </tr> <tr> <td>Date of Birth</td> <td>dim_player</td> <td>date_of_birth</td> <td>Format: YYYYMMDD</td> </tr> <tr> <td>SSN/TIN</td> <td>dim_player</td> <td>ssn_encrypted</td> <td>Decrypt for filing</td> </tr> <tr> <td>Address</td> <td>dim_player</td> <td>address_line1, city, state, zip</td> <td>Concatenate</td> </tr> <tr> <td>ID Type</td> <td>dim_player</td> <td>id_type</td> <td>Map to FinCEN codes</td> </tr> <tr> <td>ID Number</td> <td>dim_player</td> <td>id_number_encrypted</td> <td>Decrypt for filing</td> </tr> <tr> <td>ID State</td> <td>dim_player</td> <td>id_state</td> <td>Direct</td> </tr> </tbody> </table> <h3 id=part-ii-transaction-information>Part II - Transaction Information<a class=headerlink href=#part-ii-transaction-information title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Field</th> <th>Source Table</th> <th>Source Column</th> <th>Transformation</th> </tr> </thead> <tbody> <tr> <td>Transaction Date</td> <td>bronze_financial_transactions</td> <td>transaction_timestamp</td> <td>Extract date</td> </tr> <tr> <td>Transaction Amount</td> <td>bronze_financial_transactions</td> <td>amount</td> <td>Sum if aggregated</td> </tr> <tr> <td>Transaction Type</td> <td>bronze_financial_transactions</td> <td>transaction_type</td> <td>Map to FinCEN codes</td> </tr> <tr> <td>Cash In</td> <td>bronze_financial_transactions</td> <td>amount (where type=CASH_IN)</td> <td>Sum</td> </tr> <tr> <td>Cash Out</td> <td>bronze_financial_transactions</td> <td>amount (where type=CASH_OUT)</td> <td>Sum</td> </tr> </tbody> </table> <h3 id=part-iii-casinocard-club-information>Part III - Casino/Card Club Information<a class=headerlink href=#part-iii-casinocard-club-information title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Field</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Legal Name</td> <td>[Casino Legal Name]</td> </tr> <tr> <td>Trade Name</td> <td>[Casino DBA Name]</td> </tr> <tr> <td>EIN</td> <td>[Casino EIN]</td> </tr> <tr> <td>Address</td> <td>[Casino Address]</td> </tr> <tr> <td>Filing Institution Contact</td> <td>[Compliance Officer Name/Phone]</td> </tr> </tbody> </table> <hr> <h2 id=sql-query-for-ctr-data-extraction>SQL Query for CTR Data Extraction<a class=headerlink href=#sql-query-for-ctr-data-extraction title="Permanent link">&para;</a></h2> <div class="language-sql highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>-- CTR Data Extraction Query</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=c1>-- Run daily to identify reportable transactions</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=k>WITH</span><span class=w> </span><span class=n>daily_cash_activity</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>        </span><span class=n>player_id</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>        </span><span class=k>CAST</span><span class=p>(</span><span class=n>transaction_timestamp</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>transaction_date</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>        </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>transaction_type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CASH_IN&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cash_in</span><span class=p>,</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>        </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>transaction_type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;CASH_OUT&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cash_out</span><span class=p>,</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>        </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_cash</span><span class=p>,</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>        </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>transaction_count</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>bronze_financial_transactions</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>transaction_type</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CASH_IN&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;CASH_OUT&#39;</span><span class=p>)</span>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>transaction_timestamp</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>DAY</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>        </span><span class=k>AND</span><span class=w> </span><span class=n>transaction_timestamp</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=k>CURRENT_DATE</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>    </span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>player_id</span><span class=p>,</span><span class=w> </span><span class=k>CAST</span><span class=p>(</span><span class=n>transaction_timestamp</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=nb>DATE</span><span class=p>)</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=p>),</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=n>ctr_candidates</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>    </span><span class=k>SELECT</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>        </span><span class=n>d</span><span class=p>.</span><span class=o>*</span><span class=p>,</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>first_name</span><span class=p>,</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>last_name</span><span class=p>,</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>date_of_birth</span><span class=p>,</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>address_line1</span><span class=p>,</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>city</span><span class=p>,</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=k>state</span><span class=p>,</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>zip_code</span><span class=p>,</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>id_type</span><span class=p>,</span>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>        </span><span class=n>p</span><span class=p>.</span><span class=n>id_state</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>daily_cash_activity</span><span class=w> </span><span class=n>d</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=w>    </span><span class=k>JOIN</span><span class=w> </span><span class=n>dim_player</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>player_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>player_id</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=w>    </span><span class=k>WHERE</span><span class=w> </span><span class=n>d</span><span class=p>.</span><span class=n>total_cash</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>10000</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=k>SELECT</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=w>    </span><span class=n>player_id</span><span class=p>,</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=w>    </span><span class=n>transaction_date</span><span class=p>,</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=w>    </span><span class=n>first_name</span><span class=p>,</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a><span class=w>    </span><span class=n>last_name</span><span class=p>,</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=w>    </span><span class=n>date_of_birth</span><span class=p>,</span>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=w>    </span><span class=n>address_line1</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;, &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>city</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;, &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=k>state</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39; &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>zip_code</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>full_address</span><span class=p>,</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=w>    </span><span class=n>id_type</span><span class=p>,</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=w>    </span><span class=n>id_state</span><span class=p>,</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=w>    </span><span class=n>cash_in</span><span class=p>,</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=w>    </span><span class=n>cash_out</span><span class=p>,</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a><span class=w>    </span><span class=n>total_cash</span><span class=p>,</span>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=w>    </span><span class=n>transaction_count</span><span class=p>,</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=w>    </span><span class=k>CASE</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>total_cash</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>10000</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;CTR_REQUIRED&#39;</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;BELOW_THRESHOLD&#39;</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a><span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>filing_status</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a><span class=k>FROM</span><span class=w> </span><span class=n>ctr_candidates</span>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>transaction_date</span><span class=p>,</span><span class=w> </span><span class=n>total_cash</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span>
</span></code></pre></div> <hr> <h2 id=pyspark-implementation>PySpark Implementation<a class=headerlink href=#pyspark-implementation title="Permanent link">&para;</a></h2> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>pyspark.sql.functions</span><span class=w> </span><span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kn>from</span><span class=w> </span><span class=nn>pyspark.sql.window</span><span class=w> </span><span class=kn>import</span> <span class=n>Window</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>from</span><span class=w> </span><span class=nn>datetime</span><span class=w> </span><span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=k>def</span><span class=w> </span><span class=nf>extract_ctr_candidates</span><span class=p>(</span><span class=n>process_date</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=sd>    Extract CTR candidates for a given date.</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=sd>    Args:</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=sd>        process_date: Date to process (YYYY-MM-DD), defaults to yesterday</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=k>if</span> <span class=n>process_date</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>        <span class=n>process_date</span> <span class=o>=</span> <span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span> <span class=o>-</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&quot;%Y-%m-</span><span class=si>%d</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>    <span class=c1># Read financial transactions</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=n>df_transactions</span> <span class=o>=</span> <span class=n>spark</span><span class=o>.</span><span class=n>table</span><span class=p>(</span><span class=s2>&quot;bronze_financial_transactions&quot;</span><span class=p>)</span> \
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>        <span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=s2>&quot;transaction_type&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>isin</span><span class=p>([</span><span class=s2>&quot;CASH_IN&quot;</span><span class=p>,</span> <span class=s2>&quot;CASH_OUT&quot;</span><span class=p>]))</span> \
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>        <span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>to_date</span><span class=p>(</span><span class=s2>&quot;transaction_timestamp&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=n>process_date</span><span class=p>)</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>    <span class=c1># Aggregate by player and date</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>    <span class=n>df_daily</span> <span class=o>=</span> <span class=n>df_transactions</span><span class=o>.</span><span class=n>groupBy</span><span class=p>(</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>        <span class=s2>&quot;player_id&quot;</span><span class=p>,</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>        <span class=n>to_date</span><span class=p>(</span><span class=s2>&quot;transaction_timestamp&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>alias</span><span class=p>(</span><span class=s2>&quot;transaction_date&quot;</span><span class=p>)</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>    <span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>        <span class=nb>sum</span><span class=p>(</span><span class=n>when</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=s2>&quot;transaction_type&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&quot;CASH_IN&quot;</span><span class=p>,</span> <span class=n>col</span><span class=p>(</span><span class=s2>&quot;amount&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>otherwise</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span><span class=o>.</span><span class=n>alias</span><span class=p>(</span><span class=s2>&quot;cash_in&quot;</span><span class=p>),</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>        <span class=nb>sum</span><span class=p>(</span><span class=n>when</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=s2>&quot;transaction_type&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&quot;CASH_OUT&quot;</span><span class=p>,</span> <span class=n>col</span><span class=p>(</span><span class=s2>&quot;amount&quot;</span><span class=p>))</span><span class=o>.</span><span class=n>otherwise</span><span class=p>(</span><span class=mi>0</span><span class=p>))</span><span class=o>.</span><span class=n>alias</span><span class=p>(</span><span class=s2>&quot;cash_out&quot;</span><span class=p>),</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>        <span class=nb>sum</span><span class=p>(</span><span class=s2>&quot;amount&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>alias</span><span class=p>(</span><span class=s2>&quot;total_cash&quot;</span><span class=p>),</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>        <span class=n>count</span><span class=p>(</span><span class=s2>&quot;*&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>alias</span><span class=p>(</span><span class=s2>&quot;transaction_count&quot;</span><span class=p>)</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>    <span class=p>)</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>    <span class=c1># Filter CTR threshold</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a>    <span class=n>df_ctr</span> <span class=o>=</span> <span class=n>df_daily</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=s2>&quot;total_cash&quot;</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>10000</span><span class=p>)</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>    <span class=c1># Join with player dimension</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>    <span class=n>df_player</span> <span class=o>=</span> <span class=n>spark</span><span class=o>.</span><span class=n>table</span><span class=p>(</span><span class=s2>&quot;dim_player&quot;</span><span class=p>)</span> \
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a>        <span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=s2>&quot;is_current&quot;</span><span class=p>)</span> <span class=o>==</span> <span class=kc>True</span><span class=p>)</span> \
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>        <span class=o>.</span><span class=n>select</span><span class=p>(</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>            <span class=s2>&quot;player_id&quot;</span><span class=p>,</span> <span class=s2>&quot;first_name&quot;</span><span class=p>,</span> <span class=s2>&quot;last_name&quot;</span><span class=p>,</span> <span class=s2>&quot;date_of_birth&quot;</span><span class=p>,</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a>            <span class=s2>&quot;address_line1&quot;</span><span class=p>,</span> <span class=s2>&quot;city&quot;</span><span class=p>,</span> <span class=s2>&quot;state&quot;</span><span class=p>,</span> <span class=s2>&quot;zip_code&quot;</span><span class=p>,</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>            <span class=s2>&quot;id_type&quot;</span><span class=p>,</span> <span class=s2>&quot;id_state&quot;</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a>        <span class=p>)</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a>    <span class=n>df_ctr_report</span> <span class=o>=</span> <span class=n>df_ctr</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>df_player</span><span class=p>,</span> <span class=s2>&quot;player_id&quot;</span><span class=p>,</span> <span class=s2>&quot;left&quot;</span><span class=p>)</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a>    <span class=c1># Add metadata</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>    <span class=n>df_ctr_report</span> <span class=o>=</span> <span class=n>df_ctr_report</span> \
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>        <span class=o>.</span><span class=n>withColumn</span><span class=p>(</span><span class=s2>&quot;filing_status&quot;</span><span class=p>,</span> <span class=n>lit</span><span class=p>(</span><span class=s2>&quot;CTR_REQUIRED&quot;</span><span class=p>))</span> \
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a>        <span class=o>.</span><span class=n>withColumn</span><span class=p>(</span><span class=s2>&quot;report_generated_at&quot;</span><span class=p>,</span> <span class=n>current_timestamp</span><span class=p>())</span> \
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a>        <span class=o>.</span><span class=n>withColumn</span><span class=p>(</span><span class=s2>&quot;filing_deadline&quot;</span><span class=p>,</span> <span class=n>date_add</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=s2>&quot;transaction_date&quot;</span><span class=p>),</span> <span class=mi>15</span><span class=p>))</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a>    <span class=k>return</span> <span class=n>df_ctr_report</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=c1># Execute</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a><span class=n>ctr_data</span> <span class=o>=</span> <span class=n>extract_ctr_candidates</span><span class=p>()</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a><span class=n>ctr_data</span><span class=o>.</span><span class=n>write</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&quot;delta&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>mode</span><span class=p>(</span><span class=s2>&quot;append&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>saveAsTable</span><span class=p>(</span><span class=s2>&quot;compliance_ctr_filings&quot;</span><span class=p>)</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;CTR candidates extracted: </span><span class=si>{</span><span class=n>ctr_data</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div> <hr> <h2 id=fincen-filing-format>FinCEN Filing Format<a class=headerlink href=#fincen-filing-format title="Permanent link">&para;</a></h2> <div class="language-json highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=p>{</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class=nt>&quot;ctrReport&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=nt>&quot;reportingInstitution&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>      </span><span class=nt>&quot;legalName&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[Casino Legal Name]&quot;</span><span class=p>,</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>      </span><span class=nt>&quot;tradeName&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[Casino Trade Name]&quot;</span><span class=p>,</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>      </span><span class=nt>&quot;ein&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[EIN]&quot;</span><span class=p>,</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>      </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>        </span><span class=nt>&quot;street&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[Address]&quot;</span><span class=p>,</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>        </span><span class=nt>&quot;city&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[City]&quot;</span><span class=p>,</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>        </span><span class=nt>&quot;state&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[State]&quot;</span><span class=p>,</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>        </span><span class=nt>&quot;zip&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;[ZIP]&quot;</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>      </span><span class=p>}</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>    </span><span class=p>},</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>    </span><span class=nt>&quot;transactions&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>      </span><span class=p>{</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w>        </span><span class=nt>&quot;transactionDate&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;2024-01-15&quot;</span><span class=p>,</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>        </span><span class=nt>&quot;personInvolved&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>          </span><span class=nt>&quot;lastName&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Smith&quot;</span><span class=p>,</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w>          </span><span class=nt>&quot;firstName&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;John&quot;</span><span class=p>,</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>          </span><span class=nt>&quot;middleName&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;A&quot;</span><span class=p>,</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=w>          </span><span class=nt>&quot;dateOfBirth&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;19750315&quot;</span><span class=p>,</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=w>          </span><span class=nt>&quot;ssnOrTin&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;XXX-XX-1234&quot;</span><span class=p>,</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=w>          </span><span class=nt>&quot;address&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;123 Main St, Las Vegas, NV 89101&quot;</span><span class=p>,</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=w>          </span><span class=nt>&quot;identification&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w>            </span><span class=nt>&quot;type&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;01&quot;</span><span class=p>,</span>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=w>            </span><span class=nt>&quot;number&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;D12345678&quot;</span><span class=p>,</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=w>            </span><span class=nt>&quot;state&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;NV&quot;</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=w>          </span><span class=p>}</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=w>        </span><span class=p>},</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=w>        </span><span class=nt>&quot;cashIn&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>15000.00</span><span class=p>,</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=w>        </span><span class=nt>&quot;cashOut&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>0.00</span><span class=p>,</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=w>        </span><span class=nt>&quot;totalCash&quot;</span><span class=p>:</span><span class=w> </span><span class=mf>15000.00</span>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=w>      </span><span class=p>}</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=w>    </span><span class=p>]</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=p>}</span>
</span></code></pre></div> <hr> <h2 id=filing-workflow>Filing Workflow<a class=headerlink href=#filing-workflow title="Permanent link">&para;</a></h2> <pre class=mermaid><code>flowchart TD
    A[Daily Transaction Aggregation] --&gt; B{Total &gt;= $10,000?}
    B --&gt;|Yes| C[Extract CTR Data]
    B --&gt;|No| D[No Action Required]
    C --&gt; E[Compliance Review]
    E --&gt; F{Data Complete?}
    F --&gt;|No| G[Request Missing Info]
    G --&gt; E
    F --&gt;|Yes| H[Generate FinCEN File]
    H --&gt; I[Submit to FinCEN]
    I --&gt; J[Archive Filing]
    J --&gt; K[Update Status]</code></pre> <hr> <h2 id=compliance-checklist>Compliance Checklist<a class=headerlink href=#compliance-checklist title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Daily CTR threshold monitoring automated</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Player identification data complete</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Transaction details accurate</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Filing submitted within 15 days</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Copy retained for 5 years</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Compliance officer review documented</li> </ul> <hr> <p><a href=../ >Back to Compliance Templates</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 Microsoft Fabric POC Team </div> </div> <div class=md-social> <a href=https://github.com/fgarofalo56/Suppercharge_Microsoft_Fabric target=_blank rel=noopener title="GitHub Repository" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "content.tabs.link", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=https://unpkg.com/mermaid@10/dist/mermaid.min.js></script> </body> </html>